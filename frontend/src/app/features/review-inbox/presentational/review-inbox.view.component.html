<section class="app-page__header">
  <div>
    <div class="app-page__title">Review Inbox</div>
    <div class="app-page__subtitle">Verifica y categoriza transacciones sugeridas por IA.</div>
  </div>
  <div class="d-flex align-items-center gap-3">
    <span class="text-muted">{{ inbox().pendingCount }} pendientes</span>
    <button class="app-btn-primary">
      <i class="bi bi-check-circle me-2"></i>
      Aprobar todo
    </button>
  </div>
</section>

<section class="review-grid">
  <div class="app-card">
    <div class="d-flex align-items-center justify-content-between mb-3">
      <div class="fw-semibold">
        <i class="bi bi-clock-history me-2 text-warning"></i>
        Pendientes
      </div>
      <div class="btn-group">
        <button class="app-btn-ghost">Nuevos</button>
        <button class="app-btn-ghost">Antiguos</button>
      </div>
    </div>
    <div class="review-list">
      <div
        class="review-item"
        *ngFor="let item of inbox().items"
        [class.is-active]="item.id === inbox().selectedItem.id"
        (click)="selectItem.emit(item)"
      >
        <div class="review-item__main">
          <div class="fw-semibold">{{ item.merchant }}</div>
          <div class="text-muted-2">{{ item.category }} · {{ item.dateLabel }}</div>
        </div>
        <div class="review-item__amount">
          -{{ item.amount | currency: item.currency:'symbol':'1.0-2' }}
        </div>
        <div class="review-item__meta">
          <span class="app-chip app-chip--warning" *ngIf="item.tag">{{ item.tag }}</span>
          <span class="text-muted-2">IA {{ getConfidenceLabel(item.confidence) }}</span>
        </div>
      </div>
    </div>
    <div class="mt-3 text-center text-muted-2">Ver todas las transacciones</div>
  </div>

  <div class="app-card">
    <div class="d-flex align-items-center justify-content-between mb-4">
      <div class="fw-semibold">
        <i class="bi bi-pencil-square me-2 text-primary"></i>
        Editar detalle
      </div>
      <div class="d-flex gap-2">
        <button class="app-btn-ghost"><i class="bi bi-slash-circle"></i></button>
        <button class="app-btn-ghost"><i class="bi bi-diagram-3"></i></button>
      </div>
    </div>

    <div class="d-flex align-items-center gap-3 mb-4">
      <div class="review-avatar">{{ inbox().selectedItem.categoryIcon }}</div>
      <div>
        <div class="fw-semibold fs-5">{{ inbox().selectedItem.merchant }}</div>
        <div class="text-muted-2">{{ inbox().selectedItem.dateLabel }}</div>
      </div>
    </div>

    <div class="app-divider mb-4"></div>

    <div class="d-flex flex-column gap-3">
      <div>
        <label class="app-section-title" for="review-category">Categoría</label>
        <select id="review-category" class="app-select" [value]="inbox().selectedItem.category">
          <option *ngFor="let option of inbox().categoryOptions" [value]="option">
            {{ option }}
          </option>
        </select>
      </div>
      <div>
        <label class="app-section-title" for="review-merchant">Comercio</label>
        <input id="review-merchant" class="app-input" [value]="inbox().selectedItem.merchant" />
      </div>
      <div class="row g-3">
        <div class="col-6">
          <label class="app-section-title" for="review-date">Fecha</label>
          <input id="review-date" class="app-input" type="date" [value]="inbox().selectedItem.dateValue" />
        </div>
        <div class="col-6">
          <label class="app-section-title" for="review-amount">Monto</label>
          <input id="review-amount" class="app-input" type="number" [value]="inbox().selectedItem.amountValue" />
        </div>
      </div>
      
    </div>

    <div class="d-flex justify-content-end gap-2 mt-4">
      <button class="app-btn-ghost">Saltar</button>
      <button class="app-btn-primary">Aprobar transacción</button>
    </div>
  </div>
</section>


